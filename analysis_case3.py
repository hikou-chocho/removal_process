"""
テストケース3 分析

入力:
- Stock: cylinder, dia=50, h=80  →  z: -40 to +40, radius: 25
- Profile points (z_profile, d):
  [
    { z: 0.0,  d: 50.0 },    →  z_profile=0～20 で外径50mm
    { z: 20.0, d: 50.0 },
    { z: 20.0, d: 40.0 },    →  垂直壁、外径40mm
    { z: 40.0, d: 40.0 },
    { z: 40.0, d: 30.0 }      →  垂直壁、外径30mm
  ]

ストック座標:
  zmin = -40, zmax = +40, stock_r = 25

プロファイル→ワールド座標変換:
  z_world = zmin + z_profile
  
  z_profile=0   → z_world = -40
  z_profile=20  → z_world = -20
  z_profile=40  → z_world = 0
  
プロファイルの外形（r）:
  -40～-20: r=25 (d=50)
  -20～0:  r=20 (d=40)
  0:       r=15 (d=30) ← ここで終わり

問題:
  プロファイル回転体は z_world=0 までで終わり、
  ストック本体は z_world=+40 まで伸びている
  
  OD プロファイル: before.intersect(profile_solid)
  → profile_solid が z_world > 0 で無限に大きいわけではなく、
    プロファイルの終端（z_world=0）より上では値が定義されていない
  → 交集合をとると、z_world > 0 の部分がすべて削除される
  
  結果: プロファイル長が短いと、ストックの上部がごっそり削除される

期待されるXZ平面の2Dプロファイル:
  外側ポイント:
    (25, -40)
    (25, -20)
    (20, -20)
    (20, 0)
    (15, 0) ← 終点
    
  内側ポイント（逆順）:
    (0, 0)
    (0, -20)
    (0, -20)
    (0, -40)

wire.close() で (15,0)→(0,0)→...→(25,-40) で閉じる

revolve(360°, (0,0,0), (0,1,0)) で Z軸周りに回転
→ z=0 で完結するプロファイル回転体ができる
→ z_world > 0 の領域には形状がない

解決策:
  プロファイルの最後の z を ストックの終端まで延長する必要がある
  例: z=40 → z=80 に拡張し、最終直径を保持
"""
print(__doc__)
